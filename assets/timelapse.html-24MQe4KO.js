import{_ as r}from"./fixed_increment_advance-iwDvqivb.js";import{_ as p,r as a,o as d,c as m,d as s,a as n,b as e,w as o,e as i}from"./app-XKgWL27V.js";const u={},h=i('<h1 id="time-advancement-methods" tabindex="-1"><a class="header-anchor" href="#time-advancement-methods" aria-hidden="true">#</a> Time Advancement Methods</h1><p>The time advancement method in simulation refers to how the simulation time is progressed during the simulation process.</p><h2 id="classification-of-time-advancement-methods" tabindex="-1"><a class="header-anchor" href="#classification-of-time-advancement-methods" aria-hidden="true">#</a> Classification of Time Advancement Methods</h2><p>There are three major categories of common simulation time advancement methods:</p><ul><li>Event scheduling method: Event scheduling method is an event-based simulation method that sorts events in the simulation system and simulates them based on the order of their occurrence.</li><li>Fixed increment advancement method: The fixed increment advancement method refers to fixing a time increment during the simulation process. After setting the starting time, the simulation time is advanced based on the time increment.</li><li>Master clock advancement method: The master clock advancement method refers to controlling the entire simulation system during the simulation process using a master clock. It controls the simulation process by controlling the clock.</li></ul><h2 id="example" tabindex="-1"><a class="header-anchor" href="#example" aria-hidden="true">#</a> Example</h2><h3 id="event-scheduling-method" tabindex="-1"><a class="header-anchor" href="#event-scheduling-method" aria-hidden="true">#</a> Event Scheduling Method</h3><p>The event scheduling method is an event-based simulation method that sorts events in the simulation system and simulates them based on the order of their occurrence. During the simulation process, the simulation system determines the next event to occur based on the current simulation time and the time of each event, and advances the simulation time to the time when the event occurs.</p><p>The event scheduling method consists of the following three main steps, which are also the main steps of the control program for the event scheduling method:</p><ul><li>Time scanning: Determine the time when the next event will occur and advance the simulation clock to that moment.</li><li>Event identification: Correctly identify the event that is about to occur.</li><li>Event execution: Correctly execute the event that has occurred.</li></ul><p>The basic principle flowchart of the event scheduling method is as follows:</p>',11),k=i('<h3 id="fixed-increment-advancement-method" tabindex="-1"><a class="header-anchor" href="#fixed-increment-advancement-method" aria-hidden="true">#</a> Fixed Increment Advancement Method</h3><p>The fixed increment advancement method refers to fixing a time increment during the simulation process and advancing the time simulation based on the increment from the starting time. Within each time step, if no event occurs, the simulation clock is advanced by one unit of time T; if there are multiple events within the step, these events are considered to occur at the end of the step.</p><div style="text-align:center;"><p><img src="'+r+`" alt="Fixed Increment Advancement Method"></p><p>Example</p></div><h4 id="code-flow-example" tabindex="-1"><a class="header-anchor" href="#code-flow-example" aria-hidden="true">#</a> Code Flow Example</h4><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token keyword">while</span> scene<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    t <span class="token operator">=</span> t <span class="token operator">+</span> dt
    <span class="token keyword">if</span> t <span class="token operator">%</span> cycle <span class="token operator">~=</span> work_time <span class="token keyword">then</span>
        d <span class="token operator">=</span> d <span class="token operator">+</span> v <span class="token operator">*</span> dt
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Time after departure:&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">,</span> <span class="token string">&quot;hours&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Time after departure:&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">,</span> <span class="token string">&quot;hours, resting&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>

    car<span class="token punctuation">:</span><span class="token function">setpos</span><span class="token punctuation">(</span><span class="token function">CastToLine</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- Linear trajectory</span>

    os<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>This is the main flow of the code and cannot be used directly.</p></blockquote><h3 id="master-clock-advancement-method" tabindex="-1"><a class="header-anchor" href="#master-clock-advancement-method" aria-hidden="true">#</a> Master Clock Advancement Method</h3><p>The master clock advancement method refers to controlling the entire simulation system during the simulation process using a master clock. It controls the simulation process by controlling the clock. The master clock advancement method can be divided into two types: synchronous master clock and asynchronous master clock. Synchronous master clock means that all modules use the same master clock for advancement, while asynchronous master clock means that different modules use different master clocks for advancement.</p>`,8),v=i(`<blockquote><p>The implementation is done but the code is not included.</p></blockquote><h4 id="changes-from-the-automated-warehouse-simulation-to-the-master-clock-advancement-method" tabindex="-1"><a class="header-anchor" href="#changes-from-the-automated-warehouse-simulation-to-the-master-clock-advancement-method" aria-hidden="true">#</a> Changes from the Automated Warehouse Simulation to the Master Clock Advancement Method</h4><p>Specifically, the following changes were made based on the original approach:</p><ul><li>Most of the <code>os.sleep()</code> related to the event scheduling method were deleted. Due to the simplicity of the simulation process, the event scheduling method related to loading and unloading operations is retained to optimize resource utilization.</li><li>Set a global simulation clock and change the idea of the <code>Agv:Move()</code> function from &quot;executing tasks and refreshing the scene at a fixed step size&quot; to &quot;monitoring changes in the simulation clock duration, executing tasks based on the duration changes, and refreshing the scene&quot;.</li><li>Added simulation speed adjustment.</li></ul><p>From the above changes, it can be seen that the core of the simulation has shifted from event tasks to the simulation clock. In this, the part of scene refreshing is implemented using <code>os.clock()</code>.</p><h4 id="example-of-master-clock-advancement-method" tabindex="-1"><a class="header-anchor" href="#example-of-master-clock-advancement-method" aria-hidden="true">#</a> Example of Master Clock Advancement Method</h4><p>Below is a simple example of the dominant clock driving method and the <code>os.clock()</code> function, modified from the built-in block rotation example in MicroCityWeb.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token keyword">local</span> obj <span class="token operator">=</span> scene<span class="token punctuation">.</span><span class="token function">addobj</span><span class="token punctuation">(</span><span class="token string">&#39;box&#39;</span><span class="token punctuation">)</span>

<span class="token comment">-- Initial position</span>
<span class="token keyword">local</span> x <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">local</span> y <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">local</span> z <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">local</span> rx<span class="token punctuation">,</span> ry <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span> <span class="token comment">-- Rotation speed in the x and y directions</span>
<span class="token keyword">local</span> simspeed <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">-- Simulation speed</span>

<span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">-- Global simulation clock</span>
<span class="token keyword">local</span> t0 <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- Record the start time of the simulation</span>
<span class="token keyword">while</span> scene<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token keyword">local</span> dt <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t0 <span class="token comment">-- Calculate the time difference since the last recorded time</span>
    t <span class="token operator">=</span> t <span class="token operator">+</span> dt <span class="token comment">-- Move the simulation clock forward by the corresponding time difference</span>
    
    <span class="token comment">-- Set the current rotation position of the block</span>
	x <span class="token operator">=</span> x <span class="token operator">+</span> rx <span class="token operator">*</span> dt <span class="token operator">*</span> simspeed 
	y <span class="token operator">=</span> y <span class="token operator">+</span> ry <span class="token operator">*</span> dt <span class="token operator">*</span> simspeed 
	obj<span class="token punctuation">:</span><span class="token function">setrot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span>
	
    t0 <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- Record the simulation time</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Explanation:</p><ul><li>When the simulation speed <code>simspeed</code> is 1, it means that the simulation clock is moving at the same speed as the real-world clock. <code>simspeed</code> can be considered as an acceleration factor.</li><li><code>dt</code> represents the time difference between two recorded times, and the time step in the simulation is calculated as <code>dt * simspeed</code>.<div class="hint-container info"><p class="hint-container-title">Info</p><p>It should be noted that the value of the time increment <code>dt</code> is generally not the same in each loop cycle, and the specific value of <code>dt</code> generally depends on the computational power of the computer.</p></div><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>Sometimes there is not much time-consuming operation between two recorded times, and the calculated <code>dt</code> may be 0. Generally, there is a <code>scene.render()</code> between two time recordings, which usually ensures a non-zero time difference between the two samples.</p></div></li></ul>`,10),f={href:"https://github.com/huuhghhgyg/MicroCityNotes/issues/new",target:"_blank",rel:"noopener noreferrer"},b=n("strong",null,"feedback",-1);function g(w,y){const c=a("FlowChart"),t=a("RouterLink"),l=a("ExternalLinkIcon");return d(),m("div",null,[h,s(c,{id:"flowchart-61",code:"eJxVjjEOwjAMRfecwiMMvUCkeEEZmMsFotRQi9ZBjYuA0+OEicn6/9vPn4U1YNW0qYezCU4Lf5JyEVdzkoDlQVvXHi68EozmCsvN0YvyXxyfJArR7L3fc6WAuchk1JafZsp34CuwAlfQmYBkcrZkw8PI6750FESzXas2YCsxYPs1oAEb9CDl+Au6elM1Se4LQWVHAA==",preset:"vue"}),n("p",null,[e("For the specific implementation of the event scheduling method in MicroCityWeb, please refer to "),s(t,{to:"/en/notes/event-scheduling.html"},{default:o(()=>[e("Discrete Event Simulation and Program Control - Coroutine")]),_:1}),e(".")]),k,n("p",null,[e("The last part of the "),s(t,{to:"/en/notes/warehouse-simulation.html"},{default:o(()=>[e("Automated Warehouse Simulation Approach")]),_:1}),e(" mentions the "),s(t,{to:"/en/notes/warehouse-simulation.html#improvement-space"},{default:o(()=>[e("improvement space")]),_:1}),e(" and ultimately implements the master clock advancement method with synchronous master clock.")]),v,n("blockquote",null,[n("p",null,[e("This post is translated using ChatGPT, please "),n("a",f,[b,s(l)]),e(" if any omissions.")])])])}const C=p(u,[["render",g],["__file","timelapse.html.vue"]]);export{C as default};

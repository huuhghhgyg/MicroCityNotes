import{_ as n}from"./icon_script_editor-ibm_2NsU.js";import{_ as a,o as s,c as e,e as t}from"./app-IOjhnkC8.js";const o={},p=t('<h1 id="_4-6-networks" tabindex="-1"><a class="header-anchor" href="#_4-6-networks" aria-hidden="true">#</a> 4.6 Networks</h1><p>GIS vector data (<a href="3.2_vector_shapes">3.2</a>) in MicroCity can be topologized to <strong>Networks</strong> and applied the <strong>Shortest Path Algorithm</strong> and <strong>User Equilibrium Traffic Assignment Algorithm</strong>. Sample codes for this chapter can be found in the &quot;network_samples&quot; folder of the <strong>Project</strong> Tab in <img src="'+n+`" alt="icon"><strong>ScriptEditor</strong>.</p><h2 id="network-manipulation" tabindex="-1"><a class="header-anchor" href="#network-manipulation" aria-hidden="true">#</a> Network Manipulation</h2><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">CreateNetwork</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Creates an empty network and returns the object.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">CreateNetwork</span> <span class="token punctuation">(</span>UnTopoLines<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Creates a network from an untopologized <em>&quot;line&quot; Shapes</em> and returns three objects: <em>Network</em>, <em>Nodes (Shapes)</em> and <em>Links (Shapes)</em>.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">CreateNetwork</span> <span class="token punctuation">(</span>Nodes<span class="token punctuation">,</span> Links<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Creates a <em>Network</em> object from topologized Nodes and Links <em>Shapes</em>. Returns the <em>Network</em> object.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">InitNetwork</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> Nodes<span class="token punctuation">,</span> Links<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Initiates a <em>Network</em> from a Nodes and a Links <em>Shapes</em>. Returns true if succeed.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">AddLink</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> linkID<span class="token operator">|</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> oID<span class="token operator">|</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> dID<span class="token operator">|</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> impedance <span class="token punctuation">[</span><span class="token punctuation">,</span> direction <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> capacity <span class="token operator">=</span> <span class="token number">1E+38</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Adds a new link or update an existing link in the <em>Network</em>. Returns linkID, oID, dID, true/false for adding and true/false for updating.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">AddLink</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> Shapes<span class="token operator">|</span>Table<span class="token punctuation">,</span> index1 <span class="token punctuation">[</span><span class="token punctuation">,</span> index2<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Adds or updates links from the recordset of a <em>Shapes</em> or <em>Table</em>. Returns boolean values.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">DelLink</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> linkID<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Deletes a link from a <em>Network</em>. Returns a boolean value.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetNearNodeID</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token punctuation">[</span><span class="token punctuation">,</span> radius<span class="token operator">=</span><span class="token keyword">nil</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Gets the nearest <em>Network</em> nodes from a coordinate. Returns node ids.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetNodeXY</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> nodeID1 <span class="token punctuation">[</span><span class="token punctuation">,</span> nodeID2<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Returns the coordinates of nodes in a <em>Network</em>: x1, y1, x2, y2, ... .</p><h2 id="algorithms" tabindex="-1"><a class="header-anchor" href="#algorithms" aria-hidden="true">#</a> Algorithms</h2><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GenSTPTree</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> startID <span class="token punctuation">[</span><span class="token punctuation">,</span> endID<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Generates a <em>Shortest Path Spanning Tree</em> from a node. Returns a boolean value.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetSTPPath</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> endID<span class="token punctuation">,</span> <span class="token string">&quot;NodeID&quot;</span><span class="token operator">|</span><span class="token string">&quot;LinkID&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>After calling <em>GenSTPTree</em> calls this function. Returns a <em>Shortest Path</em> indicated by a node or link id sequence: id1, id2 ,... .</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetSTPPath</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> endID<span class="token punctuation">,</span> <span class="token string">&quot;iNodeShp&quot;</span><span class="token operator">|</span><span class="token string">&quot;iLinkShp&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>After calling GenSTPTree calls this function. Returns a <em>Shortest Path</em> indicated by a node or link <em>Shapes</em> index sequence.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetSTPPath</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> endID<span class="token punctuation">,</span> <span class="token string">&quot;NodeShp&quot;</span><span class="token operator">|</span><span class="token string">&quot;LinkShp&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>After calling GenSTPTree calls this function. Returns a <em>Shortest Path</em> indicated by a node or link <em>Shape</em> object sequence.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetSTPLen</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> endID<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>After calling GenSTPTree call this function. Returns a <em>Shortest Path Distance</em> to a end node.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetSTPLen</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> startID<span class="token punctuation">,</span> endID<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Gets a <em>Shortest Path</em> from a start node to an end node in a <em>Network</em>. Returns the distance.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetSTPLen</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Gets a <em>Shortest Path</em> from a start coordinate to an end coordinate in a <em>Network</em>. Returns the distance.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">SetTrip</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> oID<span class="token punctuation">,</span> dID<span class="token punctuation">,</span> amount<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Sets an amount of a trip from an origin to an destination.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">SolveUE</span> <span class="token punctuation">(</span>Network <span class="token punctuation">[</span><span class="token punctuation">,</span> rootTol <span class="token operator">=</span> <span class="token number">1E-2</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> equlBrm <span class="token operator">=</span> <span class="token number">1E-5</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> maxIter <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>After calling SetTrip call this function. Performs the <em>User Equilibium Traffic Assignment</em> and returns a boolean value.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">GetFlow</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> linkID<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Returns the traffic flow of a specified link.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token function">SetFlow</span> <span class="token punctuation">(</span>Network<span class="token punctuation">,</span> linkID<span class="token punctuation">,</span> flow<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Set the traffic flow of a specified link and return a boolean value.</p>`,44),i=[p];function u(l,c){return s(),e("div",null,i)}const k=a(o,[["render",u],["__file","4.6_networks.html.vue"]]);export{k as default};

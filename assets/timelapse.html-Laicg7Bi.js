import{_ as p}from"./fixed_increment_advance-iwDvqivb.js";import{_ as r,r as t,o as d,c as u,d as s,a as n,b as e,w as o,e as i}from"./app-WB5ROtMu.js";const m={},h=i('<h1 id="advancement-of-simulation-time" tabindex="-1"><a class="header-anchor" href="#advancement-of-simulation-time"><span>Advancement of Simulation Time</span></a></h1><p>The advancement of time in simulation refers to how the simulation time is progressed during the simulation process.</p><h2 id="classification-of-time-advancement-methods" tabindex="-1"><a class="header-anchor" href="#classification-of-time-advancement-methods"><span>Classification of Time Advancement Methods</span></a></h2><p>There are three main types of commonly used methods for advancing simulation time:</p><ul><li><strong>Event Scheduling Method</strong>: The event scheduling method is an event-based simulation method that progresses time by sorting the events in the simulation system and executing activities in the order of their occurrence.</li><li><strong>Fixed Increment Advancement Method</strong>: The fixed increment advancement method refers to fixing a time increment during the simulation process. After setting the initial time, the simulation progresses by incrementing the time based on the set increment.</li><li>Activity Event Scanning Method: For systems with high uncertainty, time advancement is achieved by scanning the events occurring in the system and executing the corresponding activities. This method may be more difficult to implement and can result in inaccurate time advancement (with errors), which could be due to my insufficient expertise. ðŸ˜¥</li></ul><h2 id="example" tabindex="-1"><a class="header-anchor" href="#example"><span>Example</span></a></h2><h3 id="event-scheduling-method" tabindex="-1"><a class="header-anchor" href="#event-scheduling-method"><span>Event Scheduling Method</span></a></h3><p>The event scheduling method is an event-based simulation method that progresses time by sorting the events in the simulation system and executing activities in the order of their occurrence. During the simulation process, the simulation system progresses time to the next event and executes the corresponding activities based on the current simulation time and remaining events.</p><p>The event scheduling method can be divided into the following three main steps, which are also the main steps of the control program for event scheduling:</p><ul><li>Time Scanning: Determines the next event occurrence time and advances the simulation clock to that moment.</li><li>Event Identification: Accurately identifies the event to occur.</li><li>Event Execution: Accurately executes the event that occurs.</li></ul><p>The basic principle flowchart of the event scheduling method is as follows:</p>',11),k=i('<h3 id="fixed-increment-advancement-method" tabindex="-1"><a class="header-anchor" href="#fixed-increment-advancement-method"><span>Fixed Increment Advancement Method</span></a></h3><p>The fixed increment advancement method refers to progressing time by a fixed step length starting from the initial time during the simulation process. Within each step length, if no event occurs, the simulation clock advances by a unit of time T. If there are several events within the step, they are executed in order, and these events are considered to have occurred at the end of the step.</p><div style="text-align:center;"><p><img src="'+p+`" alt="Fixed Increment Advancement Method"></p><p>Example Problem</p></div><h4 id="code-flow-example" tabindex="-1"><a class="header-anchor" href="#code-flow-example"><span>Code Flow Example</span></a></h4><div class="language-lua line-numbers-mode" data-ext="lua" data-title="lua"><pre class="language-lua"><code><span class="token keyword">while</span> scene<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    t <span class="token operator">=</span> t <span class="token operator">+</span> dt
    <span class="token keyword">if</span> t <span class="token operator">%</span> cycle <span class="token operator">~=</span> work_time <span class="token keyword">then</span>
        d <span class="token operator">=</span> d <span class="token operator">+</span> v <span class="token operator">*</span> dt
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Time after departure:&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">,</span> <span class="token string">&quot;hours&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Time after departure:&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">,</span> <span class="token string">&quot;hours, resting&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>

    car<span class="token punctuation">:</span><span class="token function">setpos</span><span class="token punctuation">(</span><span class="token function">CastToLine</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- linear trajectory</span>

    os<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>This is the main code flow and cannot be directly used.</p></blockquote>`,6),v=i(`<h4 id="change-from-event-scheduling-to-main-clock-advancement-in-automatic-warehouse-simulation" tabindex="-1"><a class="header-anchor" href="#change-from-event-scheduling-to-main-clock-advancement-in-automatic-warehouse-simulation"><span>Change from Event Scheduling to Main Clock Advancement in Automatic Warehouse Simulation</span></a></h4><p>Specifically, the following changes were made based on the original:</p><ul><li>Most <code>os.sleep()</code> related to the event scheduling method were removed. Due to the simplicity of the simulation process, the event scheduling method related to cargo loading and unloading was retained to optimize resource utilization.</li><li>A global simulation clock was set to change the mindset of the <code>Agv:Move()</code> function from &quot;executing tasks and refreshing the scene with a fixed step length&quot; to &quot;monitoring changes in simulation clock duration, executing tasks based on the duration changes, and refreshing the scene&quot;.</li><li>Added simulation speed adjustment.</li></ul><p>From the above changes, it can be seen that the core of the simulation shifted from event tasks to the simulation clock. The part of scene refresh utilized <code>os.clock()</code>.</p><h3 id="non-fixed-increment-advancement-method" tabindex="-1"><a class="header-anchor" href="#non-fixed-increment-advancement-method"><span>Non-Fixed Increment Advancement Method</span></a></h3><p>Here is a simple example about the time advancement method and the <code>os.clock()</code> function, modified from the built-in cube rotation example in MicroCityWeb. In this example, <code>os.clock()</code> is used to calculate CPU running time, in order to achieve a certain ratio between simulated time and real-world time. The specific ratio can be adjusted by the <code>simspeed</code> (simulation speed) parameter.</p><div class="language-lua line-numbers-mode" data-ext="lua" data-title="lua"><pre class="language-lua"><code><span class="token keyword">local</span> obj <span class="token operator">=</span> scene<span class="token punctuation">.</span><span class="token function">addobj</span><span class="token punctuation">(</span><span class="token string">&#39;box&#39;</span><span class="token punctuation">)</span>

<span class="token comment">-- Initial position</span>
<span class="token keyword">local</span> x <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">local</span> y <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">local</span> z <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">local</span> rx<span class="token punctuation">,</span> ry <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span> <span class="token comment">-- rotation speeds in the x and y directions</span>
<span class="token keyword">local</span> simspeed <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">-- simulation speed</span>

<span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">-- global simulation clock</span>
<span class="token keyword">local</span> t0 <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- record the start of the simulation time</span>
<span class="token keyword">while</span> scene<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token keyword">local</span> dt <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t0 <span class="token comment">-- calculate the time difference since the last recorded time</span>
    t <span class="token operator">=</span> t <span class="token operator">+</span> dt <span class="token comment">-- simulate the corresponding length of time that has passed on the simulation clock</span>
    
    <span class="token comment">-- Set the rotation position of the cube at this moment</span>
    x <span class="token operator">=</span> x <span class="token operator">+</span> rx <span class="token operator">*</span> dt <span class="token operator">*</span> simspeed 
    y <span class="token operator">=</span> y <span class="token operator">+</span> ry <span class="token operator">*</span> dt <span class="token operator">*</span> simspeed 
    obj<span class="token punctuation">:</span><span class="token function">setrot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span>
	
    t0 <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- record the simulation time</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Related information:</p><ul><li>When the simulation speed <code>simspeed</code> is set to 1, it indicates that the simulation clock is running at the same speed as the real-world clock. <code>simspeed</code> can be considered as an acceleration factor.</li><li><code>dt</code> represents the time difference between two recorded times, and the time step in the simulation is calculated based on <code>dt*simspeed</code>.<div class="hint-container info"><p class="hint-container-title">Info</p><p>It should be noted that the value of the time increment <code>dt</code> is generally not the same in each loop cycle, and its specific value generally depends on the computer&#39;s processing power.</p></div><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>Sometimes there may not be much time-consuming operation between two recorded times, and the calculated value of <code>dt</code> may be 0. Generally, there is a <code>scene.render()</code> between two time recordings, which usually ensures that a non-zero time difference can be calculated between the two samples.</p></div></li></ul>`,9),f={href:"https://github.com/huuhghhgyg/MicroCityNotes/issues/new",target:"_blank",rel:"noopener noreferrer"},g=n("strong",null,"feedback",-1);function b(w,y){const c=t("FlowChart"),a=t("RouterLink"),l=t("ExternalLinkIcon");return d(),u("div",null,[h,s(c,{id:"flowchart-61",code:"eJxVjrEOwjAMRPd8hUcY+gORkgVlYC4/ECUutWgdVKcI+HqcMHW8O/vdEVN1XmrcqoWrCooLfWOlwkZSZOfLE7euLdxoRRjVZeK7wTemQxxeyBWC2nv/J0HnU+Gs1JZfZkwPoAmoAglM2i0zZqNXyNnCSOu+dBYEzmJMGzf4NmPwrW3wimzYE5fzP+jqg6ISzQ/z6Ugl",preset:"vue"}),n("p",null,[e("For the specific implementation of the event scheduling method in MicroCityWeb, please refer to "),s(a,{to:"/en/notes/event-scheduling.html"},{default:o(()=>[e("Discrete Event Simulation and Program Control - Coroutines")]),_:1}),e(".")]),k,n("p",null,[e("The last part of "),s(a,{to:"/en/notes/warehouse-simulation.html"},{default:o(()=>[e("Simulation Idea for Automatic Warehouse")]),_:1}),e(" mentions the "),s(a,{to:"/en/notes/warehouse-simulation.html#improvement-space"},{default:o(()=>[e("improvement space")]),_:1}),e(" and implements the global simulation clock, ultimately achieving the time advancement method. It also implements non-fixed increment advancement, as detailed in the following section.")]),v,n("blockquote",null,[n("p",null,[e("This post is translated using ChatGPT, please "),n("a",f,[g,s(l)]),e(" if any omissions.")])])])}const T=r(m,[["render",b],["__file","timelapse.html.vue"]]);export{T as default};

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.0">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="alternate" hreflang="zh-cn" href="https://huuhghhgyg.github.io/MicroCityNotes/notes/event-scheduling.html"><meta property="og:url" content="https://huuhghhgyg.github.io/MicroCityNotes/en/notes/event-scheduling.html"><meta property="og:site_name" content="MicroCity Notes"><meta property="og:title" content="Discrete Event Simulation and Program Control"><meta property="og:description" content="Coroutines MicroCityWeb provides several coroutine-related functions that facilitate the implementation of event scheduling. coroutine.queue Adds a function or coroutine to the ..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:locale:alternate" content="zh-CN"><meta property="og:updated_time" content="2023-11-26T15:09:59.000Z"><meta property="article:modified_time" content="2023-11-26T15:09:59.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Discrete Event Simulation and Program Control","image":[""],"dateModified":"2023-11-26T15:09:59.000Z","author":[]}</script><meta name="keywords" content="MicroCity,Notes,Docs"><link rel="manifest" href="/MicroCityNotes/manifest.webmanifest"><title>Discrete Event Simulation and Program Control | MicroCity Notes</title><meta name="description" content="Coroutines MicroCityWeb provides several coroutine-related functions that facilitate the implementation of event scheduling. coroutine.queue Adds a function or coroutine to the ...">
    <link rel="preload" href="/MicroCityNotes/assets/style-gRAOaLx9.css" as="style"><link rel="stylesheet" href="/MicroCityNotes/assets/style-gRAOaLx9.css">
    <link rel="modulepreload" href="/MicroCityNotes/assets/app-IN4dFWf9.js"><link rel="modulepreload" href="/MicroCityNotes/assets/event-scheduling.html-py4kt8T8.js"><link rel="modulepreload" href="/MicroCityNotes/assets/event-scheduling.html-jr1GkxDZ.js"><link rel="modulepreload" href="/MicroCityNotes/assets/CommandBar-jgj8yIQP.js">
    
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/MicroCityNotes/en/" class=""><img class="logo" src="/MicroCityNotes/images/icon_microcitynotes.png" alt="MicroCity Notes"><span class="site-name can-hide">MicroCity Notes</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/MicroCityNotes/en/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/MicroCityNotes/en/notes/" class="router-link-active" aria-label="Notes"><!--[--><!--]--> Notes <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Documentation"><span class="title">Documentation</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Documentation"><span class="title">Documentation</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><a href="/MicroCityNotes/en/docs/" class="" aria-label="Desktop Documentation"><!--[--><!--]--> Desktop Documentation <!--[--><!--]--></a></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/MicroCityNotes/en/docs/1.1_what_microcity_can_do" class="" aria-label="1. MicroCity Introduction"><!--[--><!--]--> 1. MicroCity Introduction <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/MicroCityNotes/en/docs/2.1_showing_a_world_map" class="" aria-label="2. Getting Started with MicroCity"><!--[--><!--]--> 2. Getting Started with MicroCity <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/MicroCityNotes/en/docs/3.1_ui_overview" class="" aria-label="3. User Interface"><!--[--><!--]--> 3. User Interface <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/MicroCityNotes/en/docs/4.1_si_overview" class="" aria-label="4. Script Writing"><!--[--><!--]--> 4. Script Writing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="MicroCity Repositories"><span class="title">MicroCity Repositories</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="MicroCity Repositories"><span class="title">MicroCity Repositories</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>GitHub</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/microcity/Desktop" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Desktop"><!--[--><!--]--> MicroCity Desktop <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/microcity/microcity.github.io" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Web"><!--[--><!--]--> MicroCity Web <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Gitee</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://gitee.com/microcity/microcity" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Web"><!--[--><!--]--> MicroCity Web <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://gitee.com/microcity/desktop" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Desktop"><!--[--><!--]--> MicroCity Desktop <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://microcity.gitee.io/" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Web"><!--[--><!--]--> MicroCity Web <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/MicroCityNotes/notes/event-scheduling.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div class="search-box" role="search" data-v-fd6cd4d5><input value="" aria-label="Search" class="" placeholder="Search" autocomplete="off" spellcheck="false" data-v-fd6cd4d5><!----></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/MicroCityNotes/en/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/MicroCityNotes/en/notes/" class="router-link-active" aria-label="Notes"><!--[--><!--]--> Notes <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Documentation"><span class="title">Documentation</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Documentation"><span class="title">Documentation</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><a href="/MicroCityNotes/en/docs/" class="" aria-label="Desktop Documentation"><!--[--><!--]--> Desktop Documentation <!--[--><!--]--></a></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/MicroCityNotes/en/docs/1.1_what_microcity_can_do" class="" aria-label="1. MicroCity Introduction"><!--[--><!--]--> 1. MicroCity Introduction <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/MicroCityNotes/en/docs/2.1_showing_a_world_map" class="" aria-label="2. Getting Started with MicroCity"><!--[--><!--]--> 2. Getting Started with MicroCity <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/MicroCityNotes/en/docs/3.1_ui_overview" class="" aria-label="3. User Interface"><!--[--><!--]--> 3. User Interface <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/MicroCityNotes/en/docs/4.1_si_overview" class="" aria-label="4. Script Writing"><!--[--><!--]--> 4. Script Writing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="MicroCity Repositories"><span class="title">MicroCity Repositories</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="MicroCity Repositories"><span class="title">MicroCity Repositories</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>GitHub</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/microcity/Desktop" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Desktop"><!--[--><!--]--> MicroCity Desktop <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/microcity/microcity.github.io" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Web"><!--[--><!--]--> MicroCity Web <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Gitee</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://gitee.com/microcity/microcity" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Web"><!--[--><!--]--> MicroCity Web <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://gitee.com/microcity/desktop" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Desktop"><!--[--><!--]--> MicroCity Desktop <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://microcity.gitee.io/" rel="noopener noreferrer" target="_blank" aria-label="MicroCity Web"><!--[--><!--]--> MicroCity Web <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/MicroCityNotes/notes/event-scheduling.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/MicroCityNotes/en/notes/" class="router-link-active sidebar-item sidebar-heading" aria-label="Table of Contents"><!--[--><!--]--> Table of Contents <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">General Knowledge <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/MicroCityNotes/en/notes/lua.html" class="sidebar-item" aria-label="Quick Start with Lua Language"><!--[--><!--]--> Quick Start with Lua Language <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/versions.html" class="sidebar-item" aria-label="Versions of MicroCity"><!--[--><!--]--> Versions of MicroCity <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/timelapse.html" class="sidebar-item" aria-label="Advancement of Simulation Time"><!--[--><!--]--> Advancement of Simulation Time <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/oop.html" class="sidebar-item" aria-label="Object-Oriented Programming"><!--[--><!--]--> Object-Oriented Programming <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/tools.html" class="sidebar-item" aria-label="Tools"><!--[--><!--]--> Tools <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">MicroCity <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/MicroCityNotes/en/notes/visualization.html" class="sidebar-item" aria-label="Visualization of Results"><!--[--><!--]--> Visualization of Results <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/network.html" class="sidebar-item" aria-label="Operating Networks"><!--[--><!--]--> Operating Networks <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/lp.html" class="sidebar-item" aria-label="Model Solving"><!--[--><!--]--> Model Solving <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">MicroCityWeb <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/MicroCityNotes/en/notes/web-ui.html" class="sidebar-item" aria-label="User Interface Overview"><!--[--><!--]--> User Interface Overview <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/3d-scene.html" class="sidebar-item" aria-label="3D Scene"><!--[--><!--]--> 3D Scene <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/3d-objects.html" class="sidebar-item" aria-label="3D Objects"><!--[--><!--]--> 3D Objects <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Discrete Event Simulation and Program Control"><!--[--><!--]--> Discrete Event Simulation and Program Control <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html#coroutines" class="router-link-active router-link-exact-active sidebar-item" aria-label="Coroutines"><!--[--><!--]--> Coroutines <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html#coroutine-queue" class="router-link-active router-link-exact-active sidebar-item" aria-label="coroutine.queue"><!--[--><!--]--> coroutine.queue <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html#coroutine-qtime" class="router-link-active router-link-exact-active sidebar-item" aria-label="coroutine.qtime"><!--[--><!--]--> coroutine.qtime <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html#example" class="router-link-active router-link-exact-active sidebar-item" aria-label="Example"><!--[--><!--]--> Example <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html#random-numbers" class="router-link-active router-link-exact-active sidebar-item" aria-label="Random Numbers"><!--[--><!--]--> Random Numbers <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html#creating-a-random-seed" class="router-link-active router-link-exact-active sidebar-item" aria-label="Creating a Random Seed"><!--[--><!--]--> Creating a Random Seed <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html#example-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="Example"><!--[--><!--]--> Example <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/MicroCityNotes/en/notes/event-scheduling.html#program-control" class="router-link-active router-link-exact-active sidebar-item" aria-label="Program Control"><!--[--><!--]--> Program Control <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/MicroCityNotes/en/notes/mip.html" class="sidebar-item" aria-label="Mixed integer programming"><!--[--><!--]--> Mixed integer programming <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/debug.html" class="sidebar-item" aria-label="Debugging"><!--[--><!--]--> Debugging <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Concepts <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/MicroCityNotes/en/notes/warehouse-simulation.html" class="sidebar-item" aria-label="Ideas for Warehouse Automation Simulation"><!--[--><!--]--> Ideas for Warehouse Automation Simulation <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/plots.html" class="sidebar-item" aria-label="General Drawing Code"><!--[--><!--]--> General Drawing Code <!--[--><!--]--></a><!----></li><li><a href="/MicroCityNotes/en/notes/cy-simulation.html" class="sidebar-item" aria-label="Port AGV Service Process 3D Simulation Approach"><!--[--><!--]--> Port AGV Service Process 3D Simulation Approach <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="discrete-event-simulation-and-program-control" tabindex="-1"><a class="header-anchor" href="#discrete-event-simulation-and-program-control" aria-hidden="true">#</a> Discrete Event Simulation and Program Control</h1><h2 id="coroutines" tabindex="-1"><a class="header-anchor" href="#coroutines" aria-hidden="true">#</a> Coroutines</h2><p>MicroCityWeb provides several coroutine-related functions that facilitate the implementation of event scheduling.</p><h3 id="coroutine-queue" tabindex="-1"><a class="header-anchor" href="#coroutine-queue" aria-hidden="true">#</a> coroutine.queue</h3><p>Adds a function or coroutine to the coroutine queue for execution after a specified relative time.</p><div class="language-lua" data-ext="lua"><pre class="language-lua"><code>coroutine<span class="token punctuation">.</span><span class="token function">queue</span><span class="token punctuation">(</span>rt<span class="token punctuation">,</span> f<span class="token operator">|</span>co <span class="token punctuation">[</span><span class="token punctuation">,</span> argument list<span class="token punctuation">...</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Parameters</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>rt</code></td><td>Relative time from the current queue. It should be greater than or equal to 0. In other words, it specifies the time after which the input function or coroutine will be executed.</td></tr><tr><td><code>f/co</code></td><td>Function or coroutine. If it&#39;s a function, you only need to input the function name.</td></tr></tbody></table><h3 id="coroutine-qtime" tabindex="-1"><a class="header-anchor" href="#coroutine-qtime" aria-hidden="true">#</a> coroutine.qtime</h3><p>Retrieves the current time of the queue.</p><div class="language-lua" data-ext="lua"><pre class="language-lua"><code><span class="token keyword">local</span> time <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">qtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="example" tabindex="-1"><a class="header-anchor" href="#example" aria-hidden="true">#</a> Example</h3><p>Here are two examples provided:</p><ul><li><a href="#adding-coroutines-to-the-queue">Adding Coroutines to the Queue</a>: Demonstrates how to add coroutines to the queue and display the current queue time within the function.</li><li><a href="#vehicle-movement">Vehicle Movement</a>: Shows how to use coroutines to refresh the scene based on real-world time.</li></ul><h4 id="adding-coroutines-to-the-queue" tabindex="-1"><a class="header-anchor" href="#adding-coroutines-to-the-queue" aria-hidden="true">#</a> Adding Coroutines to the Queue</h4><p>This example demonstrates how to add coroutines to the queue and display the current queue time within the function.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token keyword">function</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Current time:&quot;</span><span class="token punctuation">,</span> coroutine<span class="token punctuation">.</span><span class="token function">qtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> <span class="token function">ShowShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Current time (short):&quot;</span><span class="token punctuation">,</span> coroutine<span class="token punctuation">.</span><span class="token function">qtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

coroutine<span class="token punctuation">.</span><span class="token function">queue</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> Show<span class="token punctuation">)</span>
coroutine<span class="token punctuation">.</span><span class="token function">queue</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> Show<span class="token punctuation">)</span>
coroutine<span class="token punctuation">.</span><span class="token function">queue</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> ShowShort<span class="token punctuation">)</span>
coroutine<span class="token punctuation">.</span><span class="token function">queue</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> Show<span class="token punctuation">)</span>

<span class="token comment">-- Result:</span>
<span class="token comment">-- Current time: 5.0</span>
<span class="token comment">-- Current time: 10.0</span>
<span class="token comment">-- Current time (short): 15.0</span>
<span class="token comment">-- Current time: 20.0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="vehicle-movement" tabindex="-1"><a class="header-anchor" href="#vehicle-movement" aria-hidden="true">#</a> Vehicle Movement</h4><p>This example demonstrates how to use coroutines to refresh the scene based on real-world time.</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code>scene<span class="token punctuation">.</span><span class="token function">setenv</span><span class="token punctuation">(</span><span class="token punctuation">{</span>grid<span class="token operator">=</span><span class="token string">&#39;plane&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">-- Set the scene background grid</span>

<span class="token comment">-- Vehicle</span>
<span class="token keyword">local</span> car <span class="token operator">=</span> scene<span class="token punctuation">.</span><span class="token function">addobj</span><span class="token punctuation">(</span><span class="token string">&#39;/res/2axle.glb&#39;</span><span class="token punctuation">)</span>
car<span class="token punctuation">.</span>speed <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- Car speed</span>

<span class="token comment">-- Initial time</span>
<span class="token keyword">local</span> t <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> dt <span class="token operator">=</span> <span class="token number">0</span>

<span class="token comment">-- Refresh time state t and dt (based on CPU intervals to synchronize with real-world time)</span>
<span class="token keyword">function</span> <span class="token function">refreshtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    dt <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t
    t <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- Coroutine updates the scene</span>
<span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> scene<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span> <span class="token comment">-- Render the scene and check if the program is terminated</span>
    coroutine<span class="token punctuation">.</span><span class="token function">queue</span><span class="token punctuation">(</span>dt<span class="token punctuation">,</span> update<span class="token punctuation">)</span> <span class="token comment">-- Add the next update based on CPU step time</span>
    <span class="token function">carmove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- Move the vehicle</span>
    <span class="token function">refreshtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- Calculate the current dt</span>
<span class="token keyword">end</span>

<span class="token comment">-- Vehicle movement</span>
<span class="token keyword">function</span> <span class="token function">carmove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Car moves at&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>
    <span class="token keyword">local</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token operator">=</span> car<span class="token punctuation">:</span><span class="token function">getpos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    car<span class="token punctuation">:</span><span class="token function">setpos</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token operator">+</span> dt <span class="token operator">*</span> car<span class="token punctuation">.</span>speed<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- Initial update (add the first update)</span>
<span class="token comment">-- Since subsequent updates are added within the function, the updates will loop automatically</span>
coroutine<span class="token punctuation">.</span><span class="token function">queue</span><span class="token punctuation">(</span>dt<span class="token punctuation">,</span> update<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="random-numbers" tabindex="-1"><a class="header-anchor" href="#random-numbers" aria-hidden="true">#</a> Random Numbers</h2><h3 id="creating-a-random-seed" tabindex="-1"><a class="header-anchor" href="#creating-a-random-seed" aria-hidden="true">#</a> Creating a Random Seed</h3><div class="language-lua" data-ext="lua"><pre class="language-lua"><code><span class="token keyword">local</span> seed <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">randomseed</span><span class="token punctuation">(</span>x <span class="token punctuation">[</span><span class="token punctuation">,</span> dist<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Parameters</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>x</code></td><td>Random seed. Different input values will produce different random numbers. To get different values each time, consider setting the random seed <code>x</code> to the current time.</td></tr><tr><td><code>dist</code></td><td>Random distribution (optional). If not set, the default is a uniform distribution. If this parameter is set, you can also specify <code>mu</code> and <code>sigma</code> as parameters for the corresponding distribution.</td></tr></tbody></table><p>The <code>dist</code> parameter can be set to one of three distributions:</p><ul><li><code>&#39;normal&#39;</code>: Normal distribution</li><li><code>&#39;exponential&#39;</code>: Exponential distribution</li><li><code>&#39;poisson&#39;</code>: Poisson distribution</li></ul><p>In addition, you can set parameters for these distributions, where the <code>mu</code> key represents the mean and the <code>sigma</code> key represents the standard deviation.</p><h3 id="example-1" tabindex="-1"><a class="header-anchor" href="#example-1" aria-hidden="true">#</a> Example</h3><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token comment">-- Create a random seed with a Poisson distribution</span>
<span class="token keyword">local</span> seed <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">randomseed</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>distribution <span class="token operator">=</span> <span class="token string">&quot;poisson&quot;</span><span class="token punctuation">,</span> mu <span class="token operator">=</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">-- Poisson distribution with a mean of 3</span>

<span class="token comment">-- Output a random number</span>
<span class="token function">print</span><span class="token punctuation">(</span>seed<span class="token punctuation">:</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="program-control" tabindex="-1"><a class="header-anchor" href="#program-control" aria-hidden="true">#</a> Program Control</h2><p>Program control, in this context, mainly refers to controlling the execution of a program using the buttons in the user interface, including pause, resume, and stop.</p><!----><blockquote><p>This mainly refers to the first three buttons in the command bar.</p></blockquote><p>In MicroCityWeb, program control refers to the pause, resume, and stop of the 3D interface rendering implemented through the <code>scene</code> object. The specific function is as follows:</p><div class="language-lua" data-ext="lua"><pre class="language-lua"><code><span class="token keyword">local</span> state <span class="token operator">=</span> scene<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Here, the return value of <code>scene.render()</code> is stored in the <code>state</code> variable. The <code>state</code> variable can be either <code>true</code> or <code>false</code>, representing the running or terminated state of the program (button 3 in the command bar).</p><p>Pausing the rendering of 3D objects is also achieved by calling <code>scene.render()</code>. If the refresh of 3D objects is implemented by continuously calling the <code>scene.render()</code> function and the refresh interval is not controlled by <code>os.sleep()</code>, it is possible to pause the rendering of the 3D interface at a certain state. This is because if <code>os.sleep()</code> is used to control the speed of 3D object movement and the pause button is clicked while the program is in the <code>os.sleep()</code> process, the program may not respond immediately, resulting in the pause button becoming ineffective. Therefore, it is recommended not to use <code>os.sleep()</code> for controlling the speed of 3D object movement, but to use other parameters to control the duration of advancement in order to control the speed of 3D object movement.</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: huuhghhgyg@outlook.com">huuhghhgyg</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/MicroCityNotes/en/notes/3d-objects.html" class="" aria-label="3D Objects"><!--[--><!--]--> 3D Objects <!--[--><!--]--></a></span><span class="next"><a href="/MicroCityNotes/en/notes/mip.html" class="" aria-label="Mixed integer programming"><!--[--><!--]--> Mixed integer programming <!--[--><!--]--></a></span></p></nav><!--[--><!--[--><!-- 评论 --><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/MicroCityNotes/assets/app-IN4dFWf9.js" defer></script>
  </body>
</html>
